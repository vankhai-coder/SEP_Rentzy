@startuml View Booking List (by renter)
!theme plain
title View Booking List (by renter) - Sequence Diagram

actor Renter as R
participant "Frontend\n(React)" as F
participant "BookingHistory\nRoute" as BR
participant "BookingHistory\nController" as BC
participant "Booking\nModel" as BM
participant "Vehicle\nModel" as VM
participant "User\nModel" as UM
participant "BookingReview\nModel" as BRM
database "MySQL\nDatabase" as DB

R -> F: 1. Request view booking list
activate F

F -> F: 2. Check authentication token

F -> BR: 3. GET /api/renter/booking-history + Cookies\n(withCredentials: true)
activate BR

BR -> BR: 4. Extract JWT token tá»« cookies\nVerify token validity (middleware)

BR -> BC: 5. Call getBookingHistory(req, res)
activate BC

BC -> BC: 6. Extract query parameters

BC -> BC: 7. Build query conditions

BC -> BM: 8. findAndCountAll with includes
activate BM

BM -> VM: 9. JOIN Vehicle table
activate VM
VM -> BM: 10. Return vehicle data
deactivate VM

BM -> UM: 11. JOIN User table
activate UM
UM -> BM: 12. Return user data
deactivate UM

BM -> BRM: 13. JOIN BookingReview table
activate BRM
BRM -> BM: 14. Return review data
deactivate BRM

BM -> DB: 15. Execute SQL query
activate DB
DB -> BM: 16. Return booking data with joins
deactivate DB

BM -> BC: 17. Return booking results
deactivate BM

BC -> BC: 18. Calculate booking prices

BC -> BC: 19. Format booking data

BC -> BC: 20. Calculate pagination info

BC -> BR: 21. Return formatted response
deactivate BC

BR -> F: 22. Return JSON response
deactivate BR

F -> F: 23. Process booking data

F -> R: 24. Display booking list with pagination
deactivate F

@enduml